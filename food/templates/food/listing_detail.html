{% extends "base.html" %}
{% block content %}
<div class="container py-5">
  <h2 class="mb-3 eggshell-text">{{ listing.title }}</h2>
  <p>{{ listing.description }}</p>
  <p><strong>Location:</strong> {{ listing.location }}</p>
  {% if listing.image %}
    <img src="{{ listing.image.url }}" class="img-card-home mb-3">
  {% endif %}

  {% if user.is_authenticated and not listing.claimed %}
    <a href="{% url 'claim_listing' listing.pk %}" class="btn navy-bg eggshell-text mb-3">Claim</a>
  {% elif listing.claimed %}
    <p><em>Claimed by {{ listing.claimer.username }}</em></p>
  {% endif %}

  <h4>Comments</h4>
  {% for comment in comments %}
    <p><strong>{{ comment.user.username }}:</strong> {{ comment.text }}</p>
  {% empty %}
    <p>No comments yet.</p>
  {% endfor %}

  {% if user.is_authenticated %}
  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn navy-bg eggshell-text mt-2">Add Comment</button>
  </form>
  {% else %}
    <p>Login to comment.</p>
  {% endif %}
</div>
{% endblock %}
